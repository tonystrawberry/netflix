<%= fields model: @movie do |form| %>
  <%= form.fields_for :movies_genres, child_index: params[:index] do |movies_genre_form| %>

    <%= turbo_stream.replace "add-movies-genre" do %>
      <%= turbo_frame_tag "add-movies-genre" do %>
        <%= link_to "Add #{Time.zone.now.to_i}",
          editor_create_movies_genre_path(movie_id: @movie&.id, index: movies_genre_form.index.to_i + 1),
          class: "rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",
          data: { turbo_stream: true, turbo_method: :post }
        %>
      <% end %>
    <% end %>

    <%= turbo_stream.append "genres" do %>
      <%= render "movies_genre_form", form: movies_genre_form %>
    <% end %>
  <% end %>
<% end %>
